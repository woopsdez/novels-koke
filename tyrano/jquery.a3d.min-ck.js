/**
 * 
 * jQuery A3D  v1.0　To use CSS3 Keyframe Animation from JavaScript
 * http:// 
 * Copyright 2012, ShikemokuMK  
 
 *Free to use and abuse under the MIT license.
 *https://twitter.com/shikemokumk
 * 
 */(function(e){function n(e){var t={};for(key in e){e[key]=""+e[key];t[key.replace(/^\s+|\s+$/g,"")]=e[key].replace(/^\s+|\s+$/g,"")}return t}function r(e,t,n){var r={};for(key in e)if(key=="x"||key=="y"||key=="z"){var i=e[key];if(i.substring(0,1)=="="){var s=parseInt(i.replace("=",""));t[key]=t[key]+s}else if(i.substring(0,1)=="*"){var s=parseInt(i.replace("*",""));t[key]=s-n[key]}else{var s=parseInt(i);t[key]=t[key]+s}delete e[key]}e.translate3d=t.x+"px,"+t.y+"px,"+t.z+"px";return e}var t=/webkit/i.test(navigator.appVersion)?"webkit":/firefox/i.test(navigator.userAgent)?"Moz":"opera"in window?"O":"";e.fn.a3d=function(i){var s=null;return this.each(function(o){var u=this,a=i.frames,f=i.config,l=i.complete,c=i.start,h=i.iteration,p={x:0,y:0,z:0},d="id_"+Math.floor(Math.random()*1e9),v={},m="",g={duration:"4s",state:"running",easing:"0.0,0.0,1.0,1.0",count:"1",delay:"0",direction:"",mode:"forwards",maintain:"true"},y=e.extend(g,n(f)),b="",w="",E={},S={},x=[];s=e.data(this,"base_point")||null;if(s==null){s=e.extend({x:0,y:0,z:0},{x:parseInt(e(this).offset().left),y:parseInt(e(this).offset().top)});e.data(this,"base_point",s)}if(!a["0%"]){var b=e.data(this,"last_frame_text")||"",w=e.data(this,"last_style_text")||"",T=e.data(this,"last_mod_frames")||{},N=e.data(this,"last_mod_styles")||{};p=e.data(this,"point")||{x:0,y:0,z:0};var C=b+"; "+w,k=" 0%{ -"+t+"-transform:";k+=C+"　} ";m=k;E=T;S=N}var L=parseInt(y.duration);y.duration.indexOf("ms")==-1&&y.duration.indexOf("s")!=-1&&(L*=1e3);for(percentage in a){var A=[],O=[];a[percentage].trans=a[percentage].trans||{};a[percentage].styles=a[percentage].styles||{};A=r(n(a[percentage].trans),p,s);O=n(a[percentage].styles);var M=" "+percentage+"{ -"+t+"-transform:",_="",D="";S=e.extend(S,O);E=e.extend(E,A);if(y.maintain=="true"){for(P in S)D+=" "+P+":"+S[P]+";";for(var P in E)_+=P+"("+E[P]+") "}else{for(P in O)D+=" "+P+":"+O[P]+";";for(var P in A)_+=P+"("+A[P]+") "}m+=M+_+"; "+D+"　} ";b=_;typeof a[percentage].ext=="function"&&function(){var e=a[percentage].ext,t=L*parseInt(percentage),n=function(){setTimeout(function(){e.call(u)},t*.01)};x.push(n)}()}if(x.length>0){typeof c!="function"&&(c=function(){});typeof h!="function"&&(h=function(){})}e.data(this,"ext_array",x);for(P in S)w+=" "+P+":"+S[P]+";";var H=b+"; "+w,B=document.styleSheets[document.styleSheets.length-1];B.insertRule("@-"+t+"-keyframes "+d+" {"+m+"} ",B.cssRules.length);var j=e(this);j.a3d_name=d;var F={"-animation-name":j.a3d_name,"-animation-duration":g.duration,"-animation-play-state":g.state,"-animation-delay":g.delay,"-animation-iteration-count":g.count,"-animation-direction":g.direction,"-animation-fill-mode":g.mode,"-animation-timing-function":g.easing},I={};for(prefix in F)I["-"+t+prefix]=F[prefix];j.css(I);e.data(this,"last_frame_text",b);e.data(this,"last_style_text",w);e.data(this,"last_mod_frames",E);e.data(this,"last_mod_styles",S);e.data(this,"point",p);if(t=="Moz"){j.css(I).one("animationend",function(){typeof l=="function"&&l.call(u)});j.css(I).bind("animationiteration",function(){typeof h=="function"&&h.call(u);var t=e.data(u,"ext_array");if(t.length>0)for(var n=0;n<t.length;n++)t[n]()});j.css(I).one("animationstart",function(){typeof c=="function"&&c.call(u);var t=e.data(u,"ext_array");if(t.length>0)for(var n=0;n<t.length;n++)t[n]()})}else{j.css(I).one(""+t+"AnimationEnd",function(){typeof l=="function"&&l.call(u)});j.css(I).bind(""+t+"AnimationIteration",function(){typeof h=="function"&&h.call(u);var t=e.data(u,"ext_array");if(t.length>0)for(var n=0;n<t.length;n++)t[n]()});j.css(I).one(""+t+"AnimationStart",function(){typeof c=="function"&&c.call(u);var t=e.data(u,"ext_array");if(t.length>0)for(var n=0;n<t.length;n++)t[n]()})}})};e.fn.a3dstate=function(n){return this.each(function(r){e(this).css("-"+t+"-animation-play-state",n)})};e.fn.a3dInfo=function(){var t=[];this.each(function(n){var r=e.data(this,"last_frame_text")||"",i=e.data(this,"last_style_text")||"",s=e.data(this,"last_mod_frames")||{},o=e.data(this,"last_mod_styles")||{},u=e.data(this,"point")||{x:0,y:0,z:0},a={point:u,frame_text:r,style_text:i,frames:s,styles:o};t.push(a)});return t};e.fn.a3dChain=function(t,n){var r=t.length,i=0,s=[],o=e(this);for(var u=0;u<t.length;u++){var a=t[u];a.complete=function(){i++;if(s.length>i){o.a3d(s[i]);o.a3dstate("running")}else typeof n=="function"&&n()};a.config.state="pause";s.push(a)}o.a3d(s[0]);o.a3dstate("running")}})(jQuery);