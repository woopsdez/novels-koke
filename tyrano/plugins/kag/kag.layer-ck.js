tyrano.plugin.kag.layer={tyrano:null,kag:null,layer_event:{},layer_menu:{},layer_free:{},map_layer_fore:{},map_layer_back:{},init:function(){var e=this,t=$("<div class='layer layer_event_click' style='z-index:9999;display:none'></div>");t.css("width",this.kag.config.scWidth).css("height",this.kag.config.scHeight).css("position","absolute");t.click(function(t){e.kag.stat.is_skip==1&&(e.kag.stat.is_skip=!1);if(e.kag.stat.is_adding_text==1){e.kag.stat.is_click_text=!0;return}if(e.kag.stat.is_click_text==1)return;if(e.kag.stat.is_stop==1)return;e.kag.stat.is_hide_message==1&&e.showMessageLayers();e.kag.ftag.nextOrder()});this.layer_event=t;this.appendLayer(this.layer_event);var n=$("<div class='layer layer_menu' style='z-index:100000000;display:none'  align='center'></div>");n.css("width",this.kag.config.scWidth).css("height",this.kag.config.scHeight).css("position","absolute");this.layer_menu=n;this.appendLayer(this.layer_menu);var r=$("<div class='layer layer_free' style='z-index:9998;display:none' ></div>");r.css("width",this.kag.config.scWidth).css("height",this.kag.config.scHeight).css("position","absolute");this.layer_free=r;this.appendLayer(this.layer_free)},getMenuLayer:function(){return this.layer_menu},getFreeLayer:function(){return this.layer_free},addLayer:function(e){var t=$("<div class='"+e+"_fore'></div>"),n=$("<div class='"+e+"_back' style='display:none'></div>");t.css("width",this.kag.config.scWidth).css("height",this.kag.config.scHeight).css("position","absolute");n.css("width",this.kag.config.scWidth).css("height",this.kag.config.scHeight).css("position","absolute");this.map_layer_fore[e]=t;this.map_layer_back[e]=n;this.map_layer_fore[e].attr("l_visible","true");this.map_layer_back[e].attr("l_visible","true");this.appendLayer(this.map_layer_fore[e]);this.appendLayer(this.map_layer_back[e])},appendLayer:function(e){$("."+this.kag.define.BASE_DIV_NAME).append(e)},appendImage:function(e){$("."+this.kag.define.BASE_DIV_NAME).append(layer_obj)},getLayer:function(e,t){if(e=="fix")return $("#tyrano_base");t=t||"fore";return t=="fore"?this.map_layer_fore[e]:this.map_layer_back[e]},updateLayer:function(e,t,n){t=t||"fore";t=="fore"?this.map_layer_fore[e]=n:this.map_layer_back[e]=n},hideMessageLayers:function(){this.kag.stat.is_hide_message=!0;var e=parseInt(this.kag.config.numMessageLayers);for(var t=0;t<e;t++)this.getLayer("message"+t).hide()},showMessageLayers:function(){this.kag.stat.is_hide_message=!1;var e=parseInt(this.kag.config.numMessageLayers);for(var t=0;t<e;t++){var n=this.getLayer("message"+t);n.attr("l_visible")=="true"&&n.show()}},appendObj:function(e,t,n){n.css("position","absolute");this.getLayer(e,t).append(n)},refMessageLayer:function(){var e=0;for(;;){if(!this.map_layer_fore["message"+e])break;var t=this.map_layer_fore["message"+e].find(".message_outer"),n=this.map_layer_fore["message"+e].find(".message_inner");n.css("left",parseInt(t.css("left"))+10).css("top",parseInt(t.css("top"))+10).css("width",parseInt(t.css("width"))-10).css("height",parseInt(t.css("height"))-10);e++}},getLayeyHtml:function(){var e={map_layer_fore:{},map_layer_back:{},layer_free:{},layer_fix:{}};for(key in this.map_layer_fore)e.map_layer_fore[key]=this.map_layer_fore[key].outerHTML();for(key in this.map_layer_back)e.map_layer_fore[key]=this.map_layer_fore[key].outerHTML();e.layer_free=this.layer_free.outerHTML();var t=0;$(".fixlayer").each(function(){e.layer_fix[t]=$(this).outerHTML();t++});return e},setLayerHtml:function(e){for(key in e.map_layer_fore){this.map_layer_fore[key].remove();delete this.map_layer_fore[key];this.map_layer_fore[key]=$(e.map_layer_fore[key]);this.appendLayer(this.map_layer_fore[key])}for(key in e.map_layer_back){this.map_layer_back[key].remove();delete this.map_layer_back[key];this.map_layer_back[key]=$(e.map_layer_back[key]);this.appendLayer(this.map_layer_back[key])}$(".fixlayer").each(function(){$(this).remove()});this.layer_free.remove();delete this.layer_free;this.layer_free=$(e.layer_free);this.appendLayer(this.layer_free)},clearMessageInnerLayerAll:function(){for(key in this.map_layer_fore)key.indexOf("message")!=-1&&this.map_layer_fore[key].find(".message_inner").html("")},backlay:function(e){e=e||"";for(key in this.map_layer_fore)if(e==""||e==key){var t=this.map_layer_fore[key].attr("class"),n=this.map_layer_back[key].attr("class");this.map_layer_back[key]=this.map_layer_fore[key].clone();this.map_layer_back[key].removeClass(t);this.map_layer_back[key].addClass(n);$("."+n).remove();this.map_layer_back[key].hide();this.appendLayer(this.map_layer_back[key])}},showEventLayer:function(){this.kag.stat.is_stop=!1;this.layer_event.show()},hideEventLayer:function(){this.kag.stat.is_stop=!0;this.layer_event.hide()},forelay:function(e){e=e||"";for(key in this.map_layer_back)if(e==""||e==key){var t=this.map_layer_fore[key].attr("class"),n=this.map_layer_back[key].attr("class");this.map_layer_fore[key]=this.map_layer_back[key].clone(!0);this.map_layer_fore[key].removeClass(n);this.map_layer_fore[key].addClass(t);$("."+t).remove();this.appendLayer(this.map_layer_fore[key]);this.map_layer_back[key].css("display","none");key.indexOf("message")!=-1&&this.map_layer_fore[key].css("opacity","")}},test:function(){}};