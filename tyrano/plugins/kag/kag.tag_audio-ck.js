tyrano.plugin.kag.tag.playbgm={vital:["storage"],pm:{loop:"true",storage:"",fadein:"false",time:2e3,target:"bgm",click:"false",stop:"false"},start:function(e){var t=this;if(e.target=="bgm"&&t.kag.stat.play_bgm==0){t.kag.ftag.nextOrder();return}if(e.target=="se"&&t.kag.stat.play_se==0){t.kag.ftag.nextOrder();return}if(t.kag.define.FLAG_APRI==1)t.playGap(e);else if($.userenv()!="pc"){this.kag.layer.hideEventLayer();if(this.kag.stat.is_skip==1&&e.target=="se"){t.kag.layer.showEventLayer();t.kag.ftag.nextOrder()}else if(e.click=="true")$(".tyrano_base").bind("click.bgm",function(){t.play(e);$(".tyrano_base").unbind("click.bgm");t.kag.layer.showEventLayer()});else{t.play(e);$(".tyrano_base").unbind("click.bgm");t.kag.layer.showEventLayer()}}else{var n=$.getBrowser();n=="firefox"||n=="opera"?t.playSwf(e):t.play(e)}},play:function(e){var t=this,n="bgm";e.target=="se"&&(n="sound");var r="";$.isHTTP(e.storage)?r=e.storage:r="./data/"+n+"/"+e.storage;var i=new Audio(r);if(e.loop=="true"){i.loop=!0;i.onended=function(){this.play()}}if(n==="bgm"){this.kag.tmp.map_bgm[e.storage]=i;t.kag.stat.current_bgm=e.storage}else this.kag.tmp.map_se[e.storage]=i;i.play();if(e.fadein=="true"){var s=jQuery.extend($("<div>")[0],{volume:0});$(s).stop().animate({volume:1},{easing:"linear",duration:parseInt(e.time),step:function(){i.volume=this.volume},complete:function(){}})}e.stop=="false"&&this.kag.ftag.nextOrder()},playGap:function(e){var t=this,n="bgm";e.target=="se"&&(n="sound");var r=null;n==="bgm"&&(this.kag.stat.current_bgm=e.storage);var i="./data/"+n+"/"+e.storage;if($.userenv()==="android"||$.userenv()==="andoroid")i=$.getBaseURL()+"data/"+n+"/"+e.storage;var r=new Media(i,function(){if(e.loop=="true"){var n=null;e.target=="bgm"?n=t.kag.tmp.map_bgm[e.storage]:n=t.kag.tmp.map_se[e.storage];n!=null&&r.play()}});e.target=="bgm"?this.kag.tmp.map_bgm[e.storage]=r:this.kag.tmp.map_se[e.storage]=r;this.playAudio(r);e.stop=="false"&&this.kag.ftag.nextOrder()},playAudio:function(e){e.play()},playSwf:function(e){var t="bgm";e.target=="se"&&(t="sound");var n=1;e.loop=="true"&&(n=9999);var t="bgm";e.target=="se"&&(t="sound");var r="";$.isHTTP(e.storage)?r=e.storage:r="./data/"+t+"/"+e.storage;if(t==="bgm"){this.kag.stat.current_bgm=e.storage;this.kag.sound_swf.playMusic(r,n)}else this.kag.sound_swf.playSound(r,n);e.stop=="false"&&this.kag.ftag.nextOrder()}};tyrano.plugin.kag.tag.stopbgm={pm:{fadeout:"false",time:2e3,target:"bgm",stop:"false"},start:function(e){var t=this,n=null;e.target=="bgm"?n=this.kag.tmp.map_bgm:n=this.kag.tmp.map_se;var r=$.getBrowser();if(t.kag.define.FLAG_APRI==1)for(key in n)(function(){var r=key,i=null;if(e.target==="bgm"){i=n[r];e.stop=="false"&&(t.kag.stat.current_bgm="")}else i=n[r];if(e.target==="bgm"){t.kag.tmp.map_bgm[r]=null;delete t.kag.tmp.map_bgm[r]}else{t.kag.tmp.map_se[r]=null;delete t.kag.tmp.map_se[r]}i.stop();i.release()})();else if(r=="firefox"||r=="opera"){this.kag.sound_swf.stopMusic();var i="bgm";e.target=="se"&&(i="sound");i==="bgm"&&e.stop=="false"&&(t.kag.stat.current_bgm="")}else for(key in n)(function(){var r=key,i=null;if(e.target==="bgm"){i=n[r];e.stop=="false"&&(t.kag.stat.current_bgm="")}else i=n[r];if(e.fadeout=="true"){var s=jQuery.extend($("<div>")[0],{volume:1});$(s).stop().animate({volume:0},{easing:"linear",duration:parseInt(e.time),step:function(){i.volume=this.volume},complete:function(){i.pause()}})}else{i.pause();e.target==="bgm"?delete t.kag.tmp.map_bgm[r]:delete t.kag.tmp.map_se[r]}})();e.stop=="false"&&this.kag.ftag.nextOrder()}};tyrano.plugin.kag.tag.fadeinbgm={vital:["storage","time"],pm:{loop:"true",storage:"",fadein:"true",time:2e3},start:function(e){this.kag.ftag.startTag("playbgm",e)}};tyrano.plugin.kag.tag.fadeoutbgm={pm:{loop:"true",storage:"",fadeout:"true",time:2e3},start:function(e){this.kag.ftag.startTag("stopbgm",e)}};tyrano.plugin.kag.tag.xchgbgm={vital:["storage","time"],pm:{loop:"true",storage:"",fadein:"true",fadeout:"true",time:2e3},start:function(e){this.kag.ftag.startTag("stopbgm",e);this.kag.ftag.startTag("playbgm",e)}};tyrano.plugin.kag.tag.playse={vital:["storage"],pm:{storage:"",target:"se",loop:"false",clear:"false"},start:function(e){e.clear=="true"&&this.kag.ftag.startTag("stopbgm",{target:"se",stop:"true"});this.kag.ftag.startTag("playbgm",e)}};tyrano.plugin.kag.tag.stopse={pm:{storage:"",fadeout:"false",time:2e3,target:"se"},start:function(e){this.kag.ftag.startTag("stopbgm",e)}};tyrano.plugin.kag.tag.fadeinse={vital:["storage","time"],pm:{storage:"",target:"se",loop:"false",fadein:"true",time:"2000"},start:function(e){this.kag.ftag.startTag("playbgm",e)}};tyrano.plugin.kag.tag.fadeoutse={pm:{storage:"",target:"se",loop:"false",fadeout:"true"},start:function(e){this.kag.ftag.startTag("stopbgm",e)}};tyrano.plugin.kag.tag.wb={pm:{},start:function(){this.kag.layer.hideEventLayer()}};tyrano.plugin.kag.tag.wc={pm:{},start:function(){this.kag.layer.hideEventLayer()}};